IEView 1.93a lister-plugin
for Total Commander 5.x-new for Win32
Freeware
-------------------------------------


   Описание
   --------
  IEView, это уникальный Листер-плагин, предназначенный для просмотра совершенно разнообразных файлов/объектов в среде Total Commander. Начиная от веб-страниц и документов Word, и заканчивая каталогами! Предназначенный для простого, быстрого и удобного просмотра, в единой среде навигации Total Commander, различного контента, он в значительной мере реализует в этой среде возможности таких программ просмотра как Проводник и Internet Explorer, а также множества других программ (таких как Word, Excel, Acrobat Reader, Quick View Plus, AutoCAD viewer, DjVu, Flash Player и многих, многих других просмотрщиков интегрирующихся с IE).
Плагин использует MS WebBrowser control (то самое, на чём построен Internet Explorer).
  Именно используя для просмотра файлов тот же самый движок, что использует Internet Explorer, плагин приобретает возможности просмотра всех тех файлов и даже каталогов, которые могут просматривать Internet Explorer и IE-совместимые браузеры. Множество программ интегрирующихся с Internet Explorer через ActiveX, делают доступным для просмотра через IEView множества дополнительных типов файлов. За счёт чего, практически любые файлы становятся по плечу данному плагину, в случае установки соответствующего софта.
  Думаю, что этот плагин, действительно без всяких скидок, можно назвать универсальным просмотрщиком.
  Конечно, существуют специализированные Листер-плагины, которые просматривают определённые файлы и делают это лучше. Но таких плагинов единицы, в то время как файловых форматов с которыми может работать IEView, многие и многие десятки. И даже если взять только самые минимальные возможности плагина (как просмотрщика веб-файлов и интегратора Проводника в Total Commander), то, даже в этом случае, мы будем вынуждены признать IEView (наряду с Imagine), без приувеличения, самым полезным Листер-плагином из всех ныне существующих.


   Установка
   ---------
1. Скопируйте/разархивируйте файлы плагина (обязательно ieview.wlx и ieview.ini) в один каталог (желательно в подкаталог Total Commander).
2. Подключите плагин:
   2.1 Окройте настройки Total Commander (выберите в меню "Конфигурация" пункт "Настройка"), перейдите на страницу "Правка/Просмотр", нажмите кнопку "Настройка внутренней программы", затем кнопку "LS-Plugins".
В окне Lister Plugins нажмите кнопку "Добавить", и, найдя каталог в который вы скопировали файлы плагина, выберите и откройте файл ieview.wlx. Переместите стрелочками добавленную запись в самый верх списка.
   или (вручную)
   2.2 Добавте в wincmd.ini в секцию [ListerPlugins] строку:
0=путь к каталогу со скопированными файлами плагина\ieview.wlx
(где 0= означает первый в списке автоматического выбора Листер-плагина, что исключает при окрытии файла соответствующего плагину типа, возможность перехвата загрузки другими плагинами).
   При любом типе установки, путь к ieview.wlx, естественно, должен быть правильный (вести в рабочий каталог со скопированными туда файлами плагина).
3. Перезапускаем Total Commander (закрыть/открыть).
4. Для установки файла настроек с русскими описаниями параметров плагина, переименуйте в рабочем каталоге плагина файл ieview.ini.rus в ieview.ini (соответственно, заменив оригинальный ieview.ini с английскими описаниями).
5. Если вы используете такие программы как DjVu, Quick View Plus, AutoCAD viewer или другие интегрирующиеся с Internet Explorer, то необходимо, в секции [Extensions] файла ieview.ini, раскоментировать строку расширений нужной программы (необходимо удалить символ ; перед строкой). Если же такая строка расширений для нужной программы отсутствует, то необходимо создать её по аналогии со строками других программ. (Будьте внимательны!)
6. Удалите из секции [Extensions] файла ieview.ini те расширения файлов, с которыми лучше работают другие используемые вами Листер-плагины, или (что лучше) переместите IEView в списке автоматического выбора Листер-плагина после данных плагинов.
7. Всё. :)


   Подробно
   --------

  Плагин одинаково хорошо работает как в режиме предварительного просмотра в панели Total Commander, так и в отдельном окне. Причём, даже без установки, через ActiveX, дополнительных программ для IE, IEView, как и IE, способен отображать любые файлы с веб-контентом (родные для IE) и даже каталоги (как Проводник). А с установленным Microsoft Office, также документы Word и Excel.
  Просмотр каталогов и файлов htm,html,shtml,plg,mht,xml,xsl,php,doc,dot,xls + графические форматы (если добавить соответствующие расширения в ieview.ini) - это только стандартные, минимальные возможности плагина!
(Внимание! По Сети гуляет полно скриптовых и макро вирусов, которые могут срабатывать при открытии файла в IE/Word/Excel и т.п. Для HTML файлов, исполнение скриптов по умолчанию запрещено в ieview.ini, но на Word/Excel это не распространяется. Прежде чем смотреть файлы Word/Excel неизвестного происхождения, позаботьтесь о своей безопасности - поставьте хороший антивирус!)

  Советую также обязательно использовать удобные возможности плагина IEView как просмотрщика PDF файлов.
  Для этого достаточно установить Acrobat Reader (если не установлен). (Нужная строка в секции [Extensions] файла ieview.ini, уже раскомментирована.)
  Для искоренения тормозов просмотра PDF файлов в IEView (отображает их через довольно массивный Acrobat Reader), советую использовать программку ускоритель для Acrobat Reader - Reader SpeedUp, предназначенную для ускорения запуска самого Adobe Acrobat Reader за счет отключения кучи ненужных плагинов (Я лично и не представлял, сколько там совершенно ненужного наворочено, и как это ужасно влияет на скорость.).
  После применения Reader SpeedUp, при установках по умолчанию, скорость открытия, и соответственно просмотра через IEView, становится просто космическая. Если, конечно, у вас не совсем древняя машина (там она становится "просто быстрой").

  Нельзя обойти вниманием, замечательный, интегрирующийся в IE, универсальный просмотрщик разнообразных файлов Quick View Plus.
  Если у вас установлена эта программа, то, для включения возможности просмотра в IEView весьма большого количества различных файлов, поддерживаемых Quick View Plus, крайне рекомендую раскомментировать в секции [Extensions] файла ieview.ini соответствующую строку. (Для поддержки всех форматов, может быть также необходима дополнительная настройка самого Quick View Plus.)
   (В строке настроек IEView по умолчанию прописаны следующие форматы: vsd,ppt,asp,drw,lwp,prz,wpd,qpw,uue,zip,123,gz,tar.)

  Для тех же, кто по роду деятельности или увлечений использует AutoCAD, совершенно настоятельно рекомендую использовать удобную возможность просмотра его файлов в среде Total Commander при помощи IEView.
Для этого необходимо установить AutoCAD viewer (например VoloView), и раскомментировать в секции [Extensions] файла ieview.ini соответствующую строку.
   (В строке настроек IEView прописаны следующие форматы: dwg,dxf,dwf,rml,ipt,iam,idw.)

  Существует также ещё одна интегрирующаяся в IE интересная программа DjVuSolo. Предназначенная, как можно догадаться, для просмотра и создания файлов формата DJVU.
  Для просмотра файлов данного формата в IEView необходимо установить DjVu Browser Plugin, и раскомментировать в секции [Extensions] файла ieview.ini соответствующую строку.
  Удивительный графический формат DJVU был разработан фирмой AT&T в первую очередь для хранения и размещения в Интернет отсканированных изображений. Изображений по форме, а по сути, документов с удобной навигацией, в графическом векторном формате высокой степени сжатия.
  Это могут быть книги, рукописи, журналы, схемы различной бытовой электроники, географические карты, художественно оформленные меню ресторанов и многое многое другое.
  Уникальной особенностью формата является черезвычайно высокая компактность при хранении изображений в высоком разрешении (300 DPI и выше). На одной дискете можно разместить до двадцати страниц высокого качества в одном файле, пригодных для распечатывания на принтере и даже для распознавания текста в FineReader (и подобных программах). Кроме того, этот формат оптимизирован для передачи по сети таким образом, что страницу можно просматривать еще до завершения скачивания всего документа.
  Таким образом, формат DJVU является уникальным инструментом для хранения различных отсканированных документов в оригинальном виде (без необходимости их немедленного и подчас некорректного распознавания), и, по сути, обеспечивает открытие Интернет-доступа к фондам обычных, бумажных библиотек (при использовании данного формата).
(Прим.: В своё время, моё знакомство с этим замечательным форматом, началось со старых советских номеров журнала "Радио", отсканированных ещё в незапамятные времена, когда сканер был роскошью, а не средством работы. Меня поразило, что толстенные журналы "Радио" (по 70 с чем-то страниц каждый) с разноцветными фотками и схемами на каждой странице, с массой мелкого текста огромных эпических статей, занимают на жестком диске считанные мегабайты (каждый, менее четырёх!). И всё это, замечу, в оригинальном виде ГРАФИЧЕСКОГО формата, пригодном для распознавания текста! Сказать, что я был в шоке, значит не сказать ничего. Ведь качество графики/текста было действительно высоким, а навигация по файлу весьма быстрой и удобной! Надо ли говорить, что я безоговорочно признал крайнюю полезность и необходимость воистину уникального формата DJVU.)

  Если вы не используете другие Листер-плагины для просмотра Flash, то рекомендую также раскомментировать соответствующую строку в секции [Extensions] файла ieview.ini.
  Впрочем, желательно использовать для просмотра файлов Flash, всё-таки другие Листер-плагины (SWF Lister lite или FlashView), имеющие строку прокрутки воспроизведения, что позоляет осуществлять удобную навигацию по Flash-видео-файлу.

  В действительности возможности просмотра IEView не ограничиваются только этими программами. Существует масса других программ интегрирующихся с Internet Explorer, и превращающих его, а следовательно IEView (и любой совместимый IE-браузер), в действительно универсальную среду просмотра разнообразных (в том числе и весьма специфических) типов файлов.


   Управление
   ----------

  Клавиши управления самого IEView (настраиваются/определяются в секции [IEViewHotkeys] ieview.ini):
Back - назад на страницу/вверх на каталог (не выше изначально открытого в IEView каталога) (в HTML или папке).
(по умочанию: Z или Backspace или Alt+Left)
Forward - вперёд на страницу/вниз на последний открытый каталог (в HTML или папке).
(по умочанию: X или Alt+Right)
GetFocus - сохранить класс текущего окна в ieview.ini -> [FocusLog]. Может быть полезно, если вы используете ActiveX Control для просмотра определенного формата, и не знаете как называется окно документа, для установки корректного перехвата фокуса.
(по умочанию: Alt+L)

  Стандартные клавиши Листер, работающие в IEView по умолчанию:
(присутствуют по умолчанию в секции [TranslationHotkeys] файла настроек ieview.ini, а опция TranslateHotkeys=1)
N - открыть следующий файл: из файловой панели (QuickView mode); из выделенных на панели (оконный режим)
P - открыть предыдущий файл: из файловой панели (QuickView mode); из выделенных на панели (оконный режим)
Ctrl+A - выделить всё
Ctrl+C или Ctrl+Insert - копировать в буфер выделенный текст
Ctrl+P - Печать...
Tab - перейти, в режиме QuickView mode, из панели предварительного просмотра IEView обратно на файловую панель
Ctrl+Q - закрыть, в режиме QuickView mode, панель предварительного просмотра, и перейти на файловую панель
Esc - закрыть окно Листера (в данном случае окно IEView)
  Виды режимов отображения файла при просмотре Листером (в данном случае IEView):
1 - Только текст
2 - Двоичный (фиксированная строка)
3 - Шестнадцатиричный
4 - Режим отображения с помощью IEView (режим по умолчанию)
5 - HTML как текст со ссылками
6 - Unicode
7 - UTF-8

  Индивидуальные клавиши некоторых программ, при помощи которых IEView (через эти программы) осуществляет дополнительное управление просмотром файлов:
(работают через программы используемые IEView для отображения и работы с файлами):

  Internet Explorer:
  (для файлов .htm;.html;.shtml;.plg;.mht;.xml;.xsl;.php;.php2;.php3)
Home - в начало страницы
End - в конец страницы
PgUp - на видимую область вверх
PgDown - на видимую область вниз
Up - вверх
Down - вниз
Scroll мыши - вертикальная прокрутка страницы
Ctrl+Scroll мыши - изменить отображаемый размер шрифтов
Левая клавиша мыши - открыть указанный документ по ссылке (под курсором)
Shift+F10 или Клавиша меню или Правая клавиша мыши - открыть контекстное меню
Ctrl+F - Поиск текста...

  Проводник:
  (для каталогов)
Home - в начало каталога
End - в конец каталога
PgUp - на группу объектов вверх
PgDown - на группу объектов вниз
Up - на объект вверх
Down - на объект вниз
Scroll мыши - вертикальная прокрутка элементов каталога
Enter или Левая клавиша мыши - открыть указанный файл или каталог (под курсором)
Alt+Enter - "Свойства" указанного файла или каталога (под курсором)...
Shift+F10 или Клавиша меню или Правая клавиша мыши - открыть контекстное меню

  Microsoft Word
  (для файлов .doc;.dot;.wbk;.wps)
Ctrl+Home - в начало документа
Ctrl+End - в конец документа
PgUp - на видимую область вверх
PgDown - на видимую область вниз
Up - вверх
Down - вниз
Shift+F10 или Клавиша меню или Правая клавиша мыши - открыть контекстное меню

  Microsoft Excel
  (для файлов .xls)
Ctrl+Home - в начало документа
Ctrl+End - в конец документа
PgUp - на видимую область вверх
PgDown - на видимую область вниз
Up - вверх
Down - вниз
Shift+F10 или Клавиша меню или Правая клавиша мыши - открыть контекстное меню

  Acrobat Reader:
  (для файлов .pdf)
Home - в начало документа
End - в конец документа
PgUp - на видимую область вверх
PgDown - на видимую область вниз
Up - вверх
Down - вниз
Right - открыть следующую страницу документа
Left - открыть предыдущую страницу документа
Держа левую клавишу, передвигать мышь - передвигаться по странице и документу (многосторонняя прокрутка)
Scroll мыши - вертикальная прокрутка документа
Shift+F10 или Клавиша меню или Правая клавиша мыши - открыть контекстное меню
Shift+Right - вправо (горизонтальная прокрутка)
Shift+Left - влево (горизонтальная прокрутка)
Shift+Ctrl+N - Перейти на страницу...
Shift+Ctrl+H - запустить/остановить автоматическую прокрутку
Ctrl+L - скрыть/показать все элементы навигации (все панели)
Ctrl+F - открыть левую боковую панель задач, как "Поиск текста"
F4 - показать/скрыть левую боковую панель задач
F6 - показать/скрыть подокно навигации (правая боковая панель)
F1 - Справка Acrobat Reader...
Ctrl+M - Изменить масштаб (размер отображения документа)...
Ctrl+0 - показать всю текущую страницу документа
Ctrl+1 - реальный размер страницы документа
Ctrl+2 - заполнить страницу по ширине окна
Ctrl+Num+ - увеличить масштаб (размер отображения документа)
Ctrl+Num- - уменьшить масштаб (размер отображения документа)
Ctrl+D - Свойства документа...
Ctrl+K - Настройка Acrobat Reader...
Ctrl+P - Печать документа...
Shift+Ctrl+S - Сохранить копию документа...
Shift+Ctrl+A - снять выделение
(Некоторые из вышеприведённых клавиш возможно не будут работать в старых версиях Acrobat Reader. Например 4.0, и более ранних.)

  DjVu Browser Plugin
  (для файлов .djvu;.djv)
Home - в начало документа
End - в конец документа
PgUp - на видимую область вверх
PgDown - на видимую область вниз
Up - вверх по странице
Down - вниз по странице
Right - вправо по странице
Left - влево по странице
Space - открыть следующую страницу документа
BackSpace - открыть предыдущую страницу документа
Держа левую клавишу, передвигать мышь - передвигаться только по странице
Num+ - увеличить масштаб (размер отображения документа)
Num- - уменьшить масштаб (размер отображения документа)
Держать Ctrl - показывать курсор как лупу (помогает читать сверхмелкий текст, и рассматривать мелкие графические элементы)
Ctrl+1 - курсор как лупа (показывать постоянно)
Ctrl+Левая клавиша мыши - выключить лупу (не показывать)
Shift+F10 или Клавиша меню или Правая клавиша мыши - открыть контекстное меню

  (В IEView работают также индивидуальные клавиши управления и великого множества других программ, используемых IEView (через ActiveX) для отображения файлов.)


   Известные проблемы и ограничения.
   ---------------------------------
- Может подтормаживать на старых медленных машинах
- На некоторых типах файлов, может перехватывать курсор с файловой панели. (Для djvu, xls, doc вроде исправлено, но требует настройки в секции [BlockFocus] - прим. Rk).
- Когда открыт вордовский файл, и открывают еще один Ворд, могут быть странные эффекты типа неработающих меню. (Прим.: Лично я такого не наблюдал не разу. Но зато при просмотре файлов Excel, открыть файл Excel в отдельном окне невозможно.)
  Вобщем, ничего серьёзного не замечено.


   История старых версий
   ---------------------
Бета 1 (неизвестно)
  Самая первая версия IEView от "Ю. Гершанова".
(Прим.: Хотелось бы поблагодарить автора "Ю. Гершанова" за идею и создание одного из наиболее востребованных плагинов для Total Commander.)
Бета 2 (1.12.2002)
- Проверка расширений теперь игнорирует регистр.
- Сделана проверка сигнатур (во избежание глюков и крэшей).
Бета 3 (3.12.2002)
- Расширение для директорий теперь не проверяется (ибо бессмысленно).
- Поправлено много мелочей, связанных с фокусом и хоткеями.
- Esc теперь обрабатывается правильнее.
- Хоткеи для Print, ProvFile, NextFile, Search теперь работают. Поиск, правда, свой в каждой программе. Листерный не работает, и не будет, так как стандартных команд поиска в Automation нет.
- Поиск по Ctrl+F теперь работает в IE тоже.
- INI file: ShowUpDir заменен на IgnoreDirs. Заготовка на будущее - давать работать другим плагинам этого типа.
Бета 4 (17.12.2002)
- Исправлен крэш на выходе из TC под Win98/ME.
- Исправлена проблема с ресурсами.
- Добавлена возможность контролировать скриптинг, загрузку графики и т.п.
- Добавлена возможность отключать показ родительской директории (который иногда требует много времени).
1.0 (22.08.2004)
  Последняя, финальная версия от "Ю. Гершанова".
(Прим.: Вместе с выходом этой версии автор прекратил дальнейшую работу и выложил исходники, в связи с нехваткой времени на поддержку и развитие плагина.)

   История новых версий
   --------------------
1.1 (31.08.2004 )
  Первая версия нового, улучшенного IEView от "Rk" под редакцией "Константина"
(Прим.: Хотелось бы поблагодарить "Rk" и "Константина" за продолжение работы над развитием этого замечательного плагина для Total Commander.)
- Исправлен перехват фокуса Acrobat Reader (не для всех версий полностью корректно).
- Теперь отсутствует необходимость дополнительного клика мышкой для перехвата фокуса веб-файлами (впрочем, на некоторых системах не всегда работает). (В режиме QuickView mode теперь достаточно нажать Tab (для перехода на панель просмотра и перехвата фокуса), а в оконном, автоматически.)
1.2 (3.09.2004)
- Исправлен баг, который не всегда позволял перехватывать фокус на некоторых системах.
(Однако при этом добавлен баг. При просмотре каталогов (в QuickView mode), курсор исчезает из файловой панели.)
1.3 (9.09.2004)
- Исправлен баг. Теперь, при просмотре каталогов (в QuickView mode), курсор не исчезает из файловой панели.
1.4 (15.09.2004)
- Исправлен перехват фокуса в Word,Excel.
- Исправлена потеря фокуса в Wordовском Splash.
- Добавлен перехват фокуса при просмотре каталогов (в QuickView mode). Аналогично веб-файлам. (Теперь Total Commander и Проводник - единое целое!)
- В ieview.ini добавлены настройки фокуса: Ключ FocusByWindowClass, Ключ UseMiddleWhenFocusByPoint, Секция [WindowClasses].
1.5 (18.09.2004)
- Исправлена потеря фокуса при просмотре каталогов и PDF. (Некорректный перехват фокуса Acrobat Reader 6.0 (курсор улетает с файловой панели) пока не исправен.)
- Теперь по каталогам и HTML можно перемещаться с помощью Backspace (вверх), Z (назад), X (вперёд). (Нужно убрать  Backspace из ieview.ini старых версий - из ключа Other=Backspace.)
- Добавлено определение файла по типу, а не только по расширению (пока работает только с HTML). (В секцию [Signatures] ieview.ini добавлен ключ %=... Сигнатура отсюда используется если имя файла не подходит под расширения в секции [Extentions]. Например, если файл называется "index.xml.ru" или "index.php@id=dif&page=8".)
1.6 (19.09.2004)
- Исправлены глюки с фокусом при смене режима отображения файла (если нажать '1' при просмотре PDF).
- Исправлены глюки с фокусом в файлах, открытых по [Signatures] %=... (автоопределение файла по типу)
- В ieview.ini добавлен ключ CaseInsensitiveSignatures (чтоб не писать отдельно "HTML","Html","html".) и ключ ListerTitle (определяет формат заголовка окна IEView).
1.7 (22.09.2004)
- Исправлен глюк с ListerTitle=1. (Прим.: Работает только для html, так как не существует понятия 'Title' для произвольного документа.)
- Добавлен Хоткей Ctrl+L.
- Добавлена Секция [BlockFocus].
1.8 (24.09.2004)
- Очередные багфиксы с фокусом.
- Секция [Hotkeys] переименована в [TranslationHotkeys]
- Добавлена секция [IEViewHotkeys]
1.9 (2.10.2004)
- ListerTitle задаётся в виде строки с переменными %TITLE, %DRIVE, %DIR, %NAME, %EXT.
- Переделан метод перехвата фокуса.
- Значения в [BlockFocus] задаются в виде "group=0/1", а не "ext=count".
- Добавлена возможность просмотра CHM (в том числе c DefaultTopic не ".\index.htm").
1.91 (10.10.2004)
- Расширена поддержка CHM
- Добавлен ключ [options] Silent
- Исправлен глюк с Excel
- Исправлен глюк с размножением окон IE
- Меняется title в Quick View при перемещении по каталогам.
1.91a (13.10.2004)
- Багфиксы
- Добавлены хоткеи: Stop, Refresh
1.92 (29.11.2004)
- поиск по F3/F7 в HTML
- Ключ [Signatures]->"%" заменен на секцию [DefaultSignatures] и ключ [options]->"CheckDefaultSignatures"
- багфиксы
1.93 (10.02.2005)
- StatusBar
- Хоткеи "RemoveImages", "CmdFind"
- багфиксы
1.93a (11.02.2005)
- багфиксы

   Для распаковки CHM была использована библиотека chmlib v0.3 by Jed Wing.


   Автор расширенного ReadMe и файла настроек ieview_rus.ini
   ---------------------------------------------------------
   "AnexeR"

   Автор старых версий
   -------------------
   "Юрий Гершанов"

   Автор новых версий
   ------------------
   "Rk" (первые версии с "Константином Власовым")
